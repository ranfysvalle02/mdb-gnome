<!doctype html>
<html lang="{{ store.lang or 'en' }}" class="scroll-smooth">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <title>{{ store.name }} - {{ business_config.name }}</title>
    <style>
        body { 
            background-color: {{ store.theme_background or '#111827' }};
            color: {{ store.theme_text or '#f9fafb' }};
        }
        /* Responsive Menu Styles */
        #mobile-menu {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background-color: {{ store.theme_surface or '#1f2937' }};
            z-index: 1000;
            padding-top: 80px;
            overflow-y: auto;
        }
        #mobile-menu.active {
            display: block;
        }
        /* Ensure desktop nav shows by default on larger screens */
        .desktop-nav {
            display: flex;
        }
        #mobile-menu a {
            display: block;
            padding: 1rem 1.5rem;
            color: {{ store.theme_text or '#f9fafb' }};
            text-decoration: none;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: background-color 0.3s ease;
        }
        #mobile-menu a:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: {{ store.theme_secondary or '#f59e0b' }};
        }
        #mobile-menu-toggle {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 0.5rem;
            z-index: 1001;
        }
        #mobile-menu-toggle span {
            width: 25px;
            height: 3px;
            background-color: {{ store.theme_text or '#f9fafb' }};
            margin: 3px 0;
            transition: 0.3s;
            border-radius: 2px;
        }
        #mobile-menu-toggle.active span:nth-child(1) {
            transform: rotate(-45deg) translate(-5px, 6px);
        }
        #mobile-menu-toggle.active span:nth-child(2) {
            opacity: 0;
        }
        #mobile-menu-toggle.active span:nth-child(3) {
            transform: rotate(45deg) translate(-5px, -6px);
        }
        @media (max-width: 767px) {
            #mobile-menu-toggle {
                display: flex !important;
            }
            .desktop-nav {
                display: none !important;
            }
            #mobile-menu.active {
                display: block !important;
            }
        }
        @media (min-width: 768px) {
            #mobile-menu {
                display: none !important;
            }
            #mobile-menu-toggle {
                display: none !important;
            }
            .desktop-nav {
                display: flex !important;
            }
        }
        /* Slideshow Styles */
        .slideshow-slide {
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
            pointer-events: none;
        }
        .slideshow-slide.active {
            opacity: 1;
            pointer-events: auto;
            z-index: 10;
        }
        @keyframes fade-in {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-fade-in {
            animation: fade-in 1s ease-out;
        }
        /* Smooth transitions for background images */
        .slideshow-slide > div {
            transition: transform 8s ease-out;
        }
        .slideshow-slide.active > div {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <header class="shadow-lg sticky top-0 z-50" style="background-color: {{ store.theme_surface or '#1f2937' }}; border-bottom: 2px solid {{ store.theme_primary or '#3b82f6' }};">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="/experiments/store_factory/{{ store.slug_id }}" class="flex items-center space-x-3">
                <img src="{{ store.logo_url or '/experiments/store_factory/static/img/logo.png' }}" alt="{{ store.name }} Logo" class="h-20 w-auto">
                <span class="text-2xl font-bold">{{ store.name }}</span>
            </a>
            <!-- Desktop Navigation -->
            <nav class="desktop-nav flex items-center space-x-6">
                <a href="#hero" class="nav-link text-white hover:text-yellow-400">Home</a>
                <a href="#{{ business_config.section_label.lower().replace(' ', '-') }}" class="nav-link text-white hover:text-yellow-400">{{ business_config.section_label }}</a>
                {% if store.specials and store.specials|length > 0 %}
                <a href="#specials" class="nav-link text-white hover:text-yellow-400">Specials</a>
                {% endif %}
                <a href="#contact" class="nav-link text-white hover:text-yellow-400">Contact</a>
                <div class="flex items-center space-x-4">
                    <a href="/experiments/store_factory/{{ store.slug_id }}/download" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md flex items-center gap-2">
                        <i class="fas fa-download"></i>
                        <span>Download Store</span>
                    </a>
                    {% if user %}
                    <a href="/experiments/store_factory/{{ store.slug_id }}/admin/dashboard" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md">Dashboard</a>
                    <form action="/experiments/store_factory/{{ store.slug_id }}/admin/logout" method="POST" class="inline">
                        <button type="submit" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md">Logout</button>
                    </form>
                    {% else %}
                    <a href="/experiments/store_factory/{{ store.slug_id }}/admin/login" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md">Login</a>
                    {% endif %}
                </div>
            </nav>
            <!-- Mobile Menu Toggle -->
            <button id="mobile-menu-toggle" aria-label="Toggle mobile menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        <!-- Mobile Navigation Menu -->
        <nav id="mobile-menu">
            <a href="#hero" class="nav-link">Home</a>
            <a href="#{{ business_config.section_label.lower().replace(' ', '-') }}" class="nav-link">{{ business_config.section_label }}</a>
            {% if store.specials and store.specials|length > 0 %}
            <a href="#specials" class="nav-link">Specials</a>
            {% endif %}
            <a href="#contact" class="nav-link">Contact</a>
            <a href="/experiments/store_factory/{{ store.slug_id }}/download" class="nav-link bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md mx-4 my-2 flex items-center justify-center gap-2">
                <i class="fas fa-download"></i>
                <span>Download Store</span>
            </a>
            {% if user %}
            <a href="/experiments/store_factory/{{ store.slug_id }}/admin/dashboard" class="nav-link">Dashboard</a>
            <form action="/experiments/store_factory/{{ store.slug_id }}/admin/logout" method="POST" class="inline-block">
                <button type="submit" class="nav-link">Logout</button>
            </form>
            {% else %}
            <a href="/experiments/store_factory/{{ store.slug_id }}/admin/login" class="nav-link">Login</a>
            {% endif %}
        </nav>
    </header>
    <main>
        {% if store.slideshow_images and store.slideshow_images|length > 0 %}
        <!-- Beautiful Slideshow Section -->
        <section id="hero-slideshow" class="relative h-screen w-full overflow-hidden">
            <div id="slideshow-container" class="relative h-full w-full">
                {% for slide in store.slideshow_images %}
                <div class="slideshow-slide absolute inset-0 w-full h-full {% if loop.index == 1 %}active{% endif %}" data-index="{{ loop.index0 }}">
                    <div class="relative w-full h-full bg-cover bg-center" style="background-image: url('{{ slide.image_url }}');">
                        <div class="absolute inset-0 bg-gradient-to-b from-black/60 via-black/40 to-black/60"></div>
                        <div class="relative h-full flex items-center justify-center text-white px-4">
                            <div class="text-center max-w-4xl mx-auto">
                                <h1 class="text-4xl md:text-6xl lg:text-7xl font-extrabold mb-4 drop-shadow-2xl animate-fade-in">
                                    {{ slide.caption or store.tagline or business_config.hero_text }}
                                </h1>
                                {% if not slide.caption %}
                                <p class="text-lg md:text-xl lg:text-2xl mt-4 opacity-90 drop-shadow-lg">{{ store.about_text or 'Welcome to our store' }}</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <!-- Navigation Arrows -->
            {% if store.slideshow_images|length > 1 %}
            <button id="slideshow-prev" class="absolute left-4 top-1/2 -translate-y-1/2 z-20 bg-black/50 hover:bg-black/70 text-white p-4 rounded-full transition-all duration-300 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-white/50">
                <i class="fas fa-chevron-left text-2xl"></i>
            </button>
            <button id="slideshow-next" class="absolute right-4 top-1/2 -translate-y-1/2 z-20 bg-black/50 hover:bg-black/70 text-white p-4 rounded-full transition-all duration-300 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-white/50">
                <i class="fas fa-chevron-right text-2xl"></i>
            </button>
            
            <!-- Dots Indicator -->
            <div id="slideshow-dots" class="absolute bottom-8 left-1/2 -translate-x-1/2 z-20 flex gap-3">
                {% for slide in store.slideshow_images %}
                <button class="slideshow-dot w-3 h-3 rounded-full transition-all duration-300 {% if loop.index == 1 %}bg-white{% else %}bg-white/50 hover:bg-white/75{% endif %}" data-index="{{ loop.index0 }}" aria-label="Go to slide {{ loop.index }}"></button>
                {% endfor %}
            </div>
            
            <!-- Play/Pause Button -->
            <button id="slideshow-play-pause" class="absolute bottom-8 right-8 z-20 bg-black/50 hover:bg-black/70 text-white p-3 rounded-full transition-all duration-300 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-white/50">
                <i id="play-pause-icon" class="fas fa-pause text-xl"></i>
            </button>
            {% endif %}
        </section>
        {% else %}
        <!-- Fallback Hero Section -->
        <section id="hero" class="h-screen bg-cover bg-center flex items-center justify-center text-white" style="background-image: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('{{ store.hero_image_url or 'https://images.pexels.com/photos/376464/pexels-photo-376464.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2' }}');">
            <div class="text-center px-4">
                <h1 class="text-4xl md:text-6xl font-extrabold">{{ store.tagline or business_config.hero_text }}</h1>
                <p class="text-lg md:text-xl mt-4 max-w-2xl mx-auto">{{ store.about_text or 'Welcome to our store' }}</p>
            </div>
        </section>
        {% endif %}
        <section id="{{ business_config.section_label.lower().replace(' ', '-') }}" class="py-16 bg-gray-800">
            <div class="container mx-auto px-6 text-center">
                <h2 class="text-4xl font-extrabold mb-4 text-white">{{ business_config.section_label }}</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                    {% for item in items %}
                    <div class="bg-gray-700 border border-gray-600 rounded-lg overflow-hidden shadow-lg">
                        <a href="/experiments/store_factory/{{ store.slug_id }}/item/{{ item._id }}">
                            <img src="{{ item.image_url or 'https://placehold.co/600x400/cccccc/ffffff?text=' + business_config.item_label }}" alt="{{ item.name }}" class="w-full h-56 object-cover">
                        </a>
                        <div class="p-6">
                            <h3 class="text-2xl font-bold text-white">{{ item.name }}</h3>
                            <p class="text-xl font-semibold text-green-400 mt-2">${{ "%.2f"|format(item.price) }}</p>
                            {% if item.status %}
                            <p class="text-sm mt-2">
                                <span class="px-2 py-1 rounded {% if item.status == 'Available' %}bg-green-900 text-green-200{% else %}bg-red-900 text-red-200{% endif %}">{{ item.status }}</span>
                            </p>
                            {% endif %}
                            <a href="/experiments/store_factory/{{ store.slug_id }}/item/{{ item._id }}" class="inline-block w-full text-center bg-gray-800 hover:bg-yellow-500 hover:text-gray-900 text-white font-bold py-2 px-4 rounded-md mt-4">View Details</a>
                        </div>
                    </div>
                    {% else %}
                    <div class="col-span-full text-center text-gray-400 py-12">
                        <p>No {{ business_config.item_plural.lower() }} available at this time.</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </section>
        {% if store.specials and store.specials|length > 0 %}
        <section id="specials" class="py-16 bg-gray-800 border-t border-gray-700">
            <div class="container mx-auto px-6 text-center">
                <h2 class="text-4xl font-extrabold mb-10 text-white">Specials & Announcements</h2>
                <div class="space-y-6 max-w-3xl mx-auto">
                    {% for special in store.specials[:3] %}
                    <div class="bg-gray-700 border border-gray-600 p-6 rounded-lg shadow-md">
                        <h3 class="text-2xl font-bold mb-2 text-white">{{ special.title }}</h3>
                        <p class="text-gray-300 whitespace-pre-wrap">{{ special.content }}</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </section>
        {% endif %}
        <section id="contact" class="py-16 bg-gray-900">
            <div class="container mx-auto px-6">
                <h2 class="text-4xl font-extrabold text-center mb-10 text-white">Visit Us</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                    <div class="bg-gray-800 border border-gray-700 p-8 rounded-lg shadow-lg">
                        <div class="space-y-6 text-lg text-gray-200">
                            {% if store.address %}
                            <div class="flex items-center gap-4">
                                <i class="fas fa-map-marker-alt text-yellow-500 text-2xl w-8 text-center"></i>
                                <span>{{ store.address }}</span>
                            </div>
                            {% endif %}
                            {% if store.hours %}
                            <div class="flex items-center gap-4">
                                <i class="fas fa-clock text-yellow-500 text-2xl w-8 text-center"></i>
                                <span>{{ store.hours | replace('\n', '<br>') | safe }}</span>
                            </div>
                            {% endif %}
                            {% if store.phone %}
                            <div class="flex items-center gap-4">
                                <i class="fas fa-phone text-yellow-500 text-2xl w-8 text-center"></i>
                                <a href="tel:{{ store.phone }}" class="hover:underline text-yellow-400">{{ store.phone_display or store.phone }}</a>
                            </div>
                            {% endif %}
                        </div>
                        {% if store.socials %}
                        <div class="mt-8 pt-6 border-t border-gray-600 flex justify-center space-x-6">
                            {% for social in store.socials %}
                            <a href="{{ social.url }}" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-yellow-500 text-3xl transition-transform transform hover:scale-110">
                                <i class="fab fa-{{ social.icon }}"></i>
                            </a>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                    {% if store.google_maps_embed_html %}
                    <div class="rounded-lg shadow-lg overflow-hidden">
                        {{ store.google_maps_embed_html | safe }}
                    </div>
                    {% endif %}
                </div>
            </div>
        </section>
    </main>
    <footer style="background-color: {{ store.theme_surface or '#1f2937' }}; color: {{ store.theme_text or '#f9fafb' }};" class="mt-12 py-10">
        <div class="container mx-auto px-6 text-center">
            <img src="{{ store.logo_url or '/experiments/store_factory/static/img/logo.png' }}" alt="Logo" class="h-16 mx-auto mb-4">
            <p>Â© {{ now.year }} {{ store.name }}.</p>
            <p class="text-sm text-gray-400 mt-2 mb-4">Powered by StoreFactory</p>
            <a href="/experiments/store_factory/{{ store.slug_id }}/download" 
               class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-green-600 hover:bg-green-700 text-white font-bold text-lg rounded-lg transition-colors uppercase shadow-lg hover:shadow-xl">
                <i class="fas fa-download text-xl"></i>
                <span>EXPORT THIS STORE</span>
            </a>
        </div>
    </footer>
    <script src="/experiments/store_factory/static/js/navigation.js"></script>
    {% if store.slideshow_images and store.slideshow_images|length > 1 %}
    <script>
        // Beautiful Slideshow Functionality
        (function() {
            const slides = document.querySelectorAll('.slideshow-slide');
            const dots = document.querySelectorAll('.slideshow-dot');
            const prevBtn = document.getElementById('slideshow-prev');
            const nextBtn = document.getElementById('slideshow-next');
            const playPauseBtn = document.getElementById('slideshow-play-pause');
            const playPauseIcon = document.getElementById('play-pause-icon');
            
            let currentIndex = 0;
            let isPlaying = true;
            let slideshowInterval;
            
            function showSlide(index) {
                // Remove active class from all slides and dots
                slides.forEach(slide => slide.classList.remove('active'));
                dots.forEach(dot => {
                    dot.classList.remove('bg-white');
                    dot.classList.add('bg-white/50');
                });
                
                // Add active class to current slide and dot
                if (slides[index]) {
                    slides[index].classList.add('active');
                }
                if (dots[index]) {
                    dots[index].classList.remove('bg-white/50');
                    dots[index].classList.add('bg-white');
                }
                
                currentIndex = index;
            }
            
            function nextSlide() {
                const nextIndex = (currentIndex + 1) % slides.length;
                showSlide(nextIndex);
            }
            
            function prevSlide() {
                const prevIndex = (currentIndex - 1 + slides.length) % slides.length;
                showSlide(prevIndex);
            }
            
            function startSlideshow() {
                if (slides.length <= 1) return;
                
                slideshowInterval = setInterval(() => {
                    if (isPlaying) {
                        nextSlide();
                    }
                }, 5000); // Change slide every 5 seconds
            }
            
            function stopSlideshow() {
                if (slideshowInterval) {
                    clearInterval(slideshowInterval);
                }
            }
            
            // Event Listeners
            if (nextBtn) {
                nextBtn.addEventListener('click', () => {
                    nextSlide();
                    // Restart timer after manual navigation
                    stopSlideshow();
                    startSlideshow();
                });
            }
            
            if (prevBtn) {
                prevBtn.addEventListener('click', () => {
                    prevSlide();
                    // Restart timer after manual navigation
                    stopSlideshow();
                    startSlideshow();
                });
            }
            
            dots.forEach((dot, index) => {
                dot.addEventListener('click', () => {
                    showSlide(index);
                    // Restart timer after manual navigation
                    stopSlideshow();
                    startSlideshow();
                });
            });
            
            if (playPauseBtn) {
                playPauseBtn.addEventListener('click', () => {
                    isPlaying = !isPlaying;
                    if (isPlaying) {
                        playPauseIcon.classList.remove('fa-play');
                        playPauseIcon.classList.add('fa-pause');
                    } else {
                        playPauseIcon.classList.remove('fa-pause');
                        playPauseIcon.classList.add('fa-play');
                    }
                });
            }
            
            // Keyboard navigation
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowLeft') {
                    prevSlide();
                    stopSlideshow();
                    startSlideshow();
                } else if (e.key === 'ArrowRight') {
                    nextSlide();
                    stopSlideshow();
                    startSlideshow();
                } else if (e.key === ' ') {
                    e.preventDefault();
                    isPlaying = !isPlaying;
                    if (isPlaying) {
                        playPauseIcon.classList.remove('fa-play');
                        playPauseIcon.classList.add('fa-pause');
                    } else {
                        playPauseIcon.classList.remove('fa-pause');
                        playPauseIcon.classList.add('fa-play');
                    }
                }
            });
            
            // Pause on hover
            const slideshowContainer = document.getElementById('slideshow-container');
            if (slideshowContainer) {
                slideshowContainer.addEventListener('mouseenter', () => {
                    const wasPlaying = isPlaying;
                    isPlaying = false;
                    playPauseIcon.classList.remove('fa-pause');
                    playPauseIcon.classList.add('fa-play');
                });
                
                slideshowContainer.addEventListener('mouseleave', () => {
                    isPlaying = true;
                    playPauseIcon.classList.remove('fa-play');
                    playPauseIcon.classList.add('fa-pause');
                });
            }
            
            // Start slideshow
            startSlideshow();
        })();
    </script>
    {% endif %}
</body>
</html>

